<!-- jQuery + Summernote -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-bs4.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-bs4.min.js"></script>

<textarea id="summernote"></textarea>

<script>
$(document).ready(function() {
    $('#summernote').summernote({
        height: 300,
        callbacks: {

            // ðŸ”¹ ÙˆÙ‚ØªÛŒ Ú©Ø§Ø±Ø¨Ø± Ø¹Ú©Ø³ Ù…ÛŒâ€ŒØ°Ø§Ø±Ù‡ ÛŒØ§ Drag & Drop Ù…ÛŒâ€ŒÚ©Ù†Ù‡
            onImageUpload: function(files) {
                for (let i = 0; i < files.length; i++) {
                    uploadImage(files[i]);
                }
            },

            // ðŸ”¹ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Paste Ú©Ø±Ø¯Ù† Base64
            onPaste: function(e) {
                let clipboard = (e.originalEvent || e).clipboardData;
                if (clipboard && clipboard.items) {
                    for (let item of clipboard.items) {
                        if (item.type.indexOf('image') !== -1) {
                            e.preventDefault(); // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Base64
                            // Ù…ÛŒØªÙˆÙ†ÛŒ Ù‡Ù…ÙˆÙ†Ø¬Ø§ upload Ú©Ù†ÛŒ
                            let file = item.getAsFile();
                            uploadImage(file);
                        }
                    }
                }
            }
        }
    });

    // ðŸ”¹ ØªØ§Ø¨Ø¹ Ø¢Ù¾Ù„ÙˆØ¯ Ø¹Ú©Ø³ Ø¨Ù‡ Ø³Ø±ÙˆØ±
    function uploadImage(file) {
        let data = new FormData();
        data.append('image', file);

        // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† CSRF Token Ù„Ø§Ø±Ø§ÙˆÙ„ (Ø¶Ø±ÙˆØ±ÛŒ)
        data.append('_token', '{{ csrf_token() }}');

        $.ajax({
            url: '/summernote/upload', // Ù…Ø³ÛŒØ± Ù„Ø§Ø±Ø§ÙˆÙ„ Ø¨Ø±Ø§ÛŒ Ø¢Ù¾Ù„ÙˆØ¯
            type: 'POST',
            data: data,
            contentType: false,
            processData: false,
            success: function(res) {
                if (res.url) {
                    // ðŸ”¹ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¹Ú©Ø³ Ø¯Ø§Ø®Ù„ Summernote
                    $('#summernote').summernote('insertImage', res.url);
                }
            },
            error: function(err) {
                alert('Ø®Ø·Ø§ Ø¯Ø± Ø¢Ù¾Ù„ÙˆØ¯ ØªØµÙˆÛŒØ±');
                console.log(err);
            }
        });
    }
});
</script>
